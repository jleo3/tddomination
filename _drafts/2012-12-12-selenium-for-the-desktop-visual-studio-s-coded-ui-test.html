---
layout: post
title: "Selenium for the Desktop: Visual Studio's Coded UI Test"
date: 2012-12-12
comments: false
---

<div class='post'>
I've been yakking away about using <a href="http://msdn.microsoft.com/en-us/library/dd286726.aspx" target="_blank">Visual Studio's Coded UI Test</a> and adding it to my automated test suite for a long time now. After a couple of false starts, I finally got myself a fully functioning test. I'm writing it up for several reasons, chief among them being that starting a Coded UI Test suite feels much like getting <a href="http://seleniumhq.org/" target="_blank">Selenium </a>off the ground in the old days and I feel for people that are trying to get this going.<br /><br />In my opinion, it's already well worth the initial effort.<br /><br />Question #1: What is it? Why should I care?<br />Answer: I hadn't heard of Coded UI Test (CUIT) before joining CS. Then I found out that one of our best QA developers was using it to automate his test suite. As far as I can tell, <a href="http://social.msdn.microsoft.com/Profile/gautam%20goenka%20%5Bmsft%5D" target="_blank">Microsoft's Gautam Goenka</a> is the mastermind behind the technology, which has been available on Visual Studio since VS2010.<br /><br />The look and feel of CUIT bears a resemblance to the Selenium IDE, but it's pure Microsoft and is optimized for working with WPF (thus, Silverlight applications are equally supported). So why use it? I use it for the same reasons that I sought out Selenium over and over on web applications in the past. I have test cases that unit tests won't reliably cover, and I want an easy way to perform end-to-end tests of my application stack.<br /><br />Question #2: How do you get started?<br />Answer: This is something that's covered in detail in many places already. So take a look at the following links to get you started:<br />- Simple step-by-step walkthrough:&nbsp;<a href="http://msdn.microsoft.com/en-us/library/dd286608(VS.100).aspx">http://msdn.microsoft.com/en-us/library/dd286608(VS.100).aspx</a><br />- Introductory walkthrough video:&nbsp;<a href="http://msdn.microsoft.com/en-us/vstudio/ee957688.aspx">http://msdn.microsoft.com/en-us/vstudio/ee957688.aspx</a><br />- Complete overview and step-by-step tutorial:&nbsp;<a href="http://msdn.microsoft.com/en-us/library/dd286726.aspx#VerifyingCodeUsingCUITCreate">http://msdn.microsoft.com/en-us/library/dd286726.aspx#VerifyingCodeUsingCUITCreate</a><br /><br />Question #3: Ok, I'm up and running and something already doesn't work.<br />Answer: Ah, yes. UI testing is never free of digging, at least not when you're first learning. Here are two things I ran into early.<br /><br /><i>My dropdown/ListBox/ComboBox/etc. isn't recognized by the recorder.</i><br />The first thing to understand is that there are two items that should be given unique names: the control itself and then each selectable item <i>within</i>&nbsp;the control. Naming the control is simple: just add it to your XAML file:<br /><br /><br /><br />Naming the control's items can be straightforward, or it can be tricky. A nice post from Gautam cleared things up for me:<br /><br /><i>My test records without any errors or warnings, but then fails with a NullReferenceException during playback.</i><br />I found the solution to this only after much digging. In fact,&nbsp;<a href="http://stackoverflow.com/questions/4663585/codedui-null-reference-exception-even-when-object-exists" target="_blank">in the StackExchange answer</a> where I finally dug this up, the same user who provided the question also provided the answer, then months later came back and commented that he forgot about it and found his own article as the only solution!<br /><br />As I come across other issues, I'll continue to post them.Also, more challenges await. I have to get these tests up and running on my Teamcity build server. Also, I have to make some more interesting tests that verify the types of interactions I can't get at using <a href="https://github.com/machine/machine.specifications" target="_blank">MSpec</a>.&nbsp;I would LOVE to hear from others who are using CUIT on a regular basis. This technology has tons of potential and some dedicated professionals building extensions, teaching the nuances, and continuing to improve it. My hopes are high.</div>
