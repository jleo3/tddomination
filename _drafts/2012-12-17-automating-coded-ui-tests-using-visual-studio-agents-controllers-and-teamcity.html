---
layout: post
title: "Automating Coded UI Tests Using Visual Studio Agents, Controllers, and TeamCity"
date: 2012-12-17
comments: false
---

<div class='post'>
Documentation is voluminous and circuitous, making the process a bit more difficult than it has to be. Plus, you may spend awhile tinkering with TeamCity's pre-installed Microsoft packages before realizing that you need some not-quite out-of-the-box tooling from Microsoft to make this whole process run smoothly. I'm going to document this process step-by-step as I do it.<br /><br />Please note:&nbsp;None of this is necessary if you are running simple NUnit, XUnit, or MSpec tests. In fact, if you host TeamCity on a Windows desktop machine you can probably get away with running your Coded UI tests there. But if you are hosting TC on Linux or any headless implementation of Windows, you'll need this scheme.<br /><br />Here goes:<br /><br /><ol><li>First, the tools. I'm using Visual Studio 2010 for the time being (the move to VS2012 is nigh, but from what I can tell the process is very similar). We use TeamCity for CI and are currently on Enterprise Version 7.1.1. We use a one-build-agent-per-VM scheme and have configured many Windows and RHEL VMs for this purpose.&nbsp;</li><li>Take a look at <a href="http://msdn.microsoft.com/en-us/library/dd293551(v=vs.100).aspx" target="_blank">Setting Up Test Machines</a> on MSDN, try to ignore the fact that there's a section called "Manual Testing," and take a look at their automated tests diagram. This is the goal. We need a test controller and a test agent for each machine that will run our automated tests.&nbsp;</li><li>The first thing you'll need is the Visual Studio Agents ISO. You can <a href="http://www.microsoft.com/en-us/download/details.aspx?id=1334" target="_blank">download it here</a>. You'll install and configure your controller and test agent from this image, so mount it or load using WinZip or WinRAR and run setup.exe.</li><li>First up is the test controller. Instructions for installing and configuring <a href="http://msdn.microsoft.com/en-us/library/dd648127(v=vs.100).aspx#TestControllers" target="_blank">can be found here</a>. This one is pretty straightforward.&nbsp;</li><li>Next you'll want to install a test agent on the same VM as your TeamCity build agent. <b>The agent must be installed as an interactive process, not a service.&nbsp;</b></li></ol></div>
